<!DOCTYPE html>
<html>
<head>
    <title>js密码检测</title>
</head>
<body>
<h3>生成强密码</h3>
<input type="button" value="生 成" onclick="getPwd(8);"/>
<input id="txt1" type="text" style="width:350px; font-family:Consolas; font-size:14px; color:Blue;"/>
<script type="text/javascript">
    function getPwd(n) {
        var s = '';
        while (n--)
            s += String.fromCharCode(33 + Math.floor(Math.random() * (126 - 33)));

        document.getElementById('txt1').value = s;
    }
</script>

<h3>计算密码破解时间</h3>
密码强度：<select id="selChar">
    <option value="10">纯数字 (10)</option>
    <option value="26">纯大写字母 (26)</option>
    <option value="36">数字+大写 (36)</option>
    <option value="52">大小写字母 (52)</option>
    <option value="62">数字+大小写 (62)</option>
    <option value="94">数字+大小写+特殊字符 (94)</option>
</select><br/>
密码位数：<input id="txtPwdLen" type="text" value="8"/><br/>
<input type="button" value="计 算" onclick="getTime();"/>
<span style="font-size:12px;">（假设使用每秒2.4G的双核CPU计算，不考虑其他因素，穷举破解）</span>
<br/><br/><span id="span2" style="color:Red;"></span>
<script type="text/javascript">
    function getTime() {
        var str = '预计破解用时：';
        var selChar = document.getElementById('selChar');
        var txtPwdLen = document.getElementById('txtPwdLen');
        var num = Math.pow(parseInt(selChar.value), parseInt(txtPwdLen.value));
        str += formatTime(num / (1024 * 1024 * 1024 * 2.4 * 2));
        document.getElementById('span2').innerHTML = str;
    }

    function formatTime(s) {
        var str = '';
        if (s < 1) return '小于1秒！';
        s = Math.floor(s);
        if (s >= 1) str = s % 60 + '秒' + str;
        s = Math.floor(s / 60);
        if (s >= 1) str = s % 60 + '分' + str;
        s = Math.floor(s / 60);
        if (s >= 1) str = s % 24 + '时' + str;
        s = Math.floor(s / 24);
        if (s >= 1) str = s + '天' + str;

        return str;
    }
</script>

<h3>密码安全检测</h3>
<input id="txt2" type="text" style="width:300px; font-family:Consolas; font-size:14px; color:Blue;"/>
<input type="button" value="检 测" onclick="showPwd();"/>
<br/><br/><span id="span1"></span>
<script type="text/javascript">
    function showPwd() {
        var p = document.getElementById('txt2').value;
        if (p.length < 4) {
            showError('密码至少4位！');
            return;
        }
        var o = checkPwd(p);
        if (o.isSame) {
            showError('密码为重复字符！');
            return;
        }
        for (var i = 0; i < arrPwd.length; i++) {
            if (arrPwd[i] == p || arrPwd[i].indexOf(p) == 0) {
                showError('密码为100大常用密码！');
                return;
            }
        }

        var year = parseInt(p.substr(0, 4));
        if (!isNaN(year) && year > 1900 && year < 2100) {
            var month = parseInt(p.substr(4, 2));
            if (!isNaN(month) && month > 0 && month < 13) {
                var day = parseInt(p.substr(6, 2));
                if (!isNaN(day) && day > 0 && day < 32) {
                    showError('不要使用日期作为密码！');
                    return;
                }
            }
        }

        var hasUpper = false;
        var hasLow = false;
        var hasNum = false;
        var hasOther = false;
        for (var i = 0; i < p.length; i++) {
            var c = p.charCodeAt(i);
            if (c >= 65 && c <= 90) hasUpper = true;
            else if (c >= 97 && c <= 122) hasLow = true;
            else if (c >= 48 && c <= 57) hasNum = true;
            else hasOther = true;
        }
        var pwdNum = 0;
        if (hasUpper) pwdNum += 26;
        if (hasLow) pwdNum += 26;
        if (hasNum) pwdNum += 10;
        if (hasOther) pwdNum += 32;

        var num = Math.pow(pwdNum, p.length);
        var str = '密码长度:' + p.length + ' 强度:' + pwdNum + ' 预计破解用时:' + formatTime(num / (1024 * 1024 * 1024 * 2.4 * 2));

        var span1 = document.getElementById('span1');
        span1.style.color = 'blue';
        span1.innerHTML = str;
    }

    function showError(str) {
        var span1 = document.getElementById('span1');
        span1.style.color = 'red';
        span1.innerHTML = str;
    }

    var arrPwd = [
        '1234567890',
        '0987654321',
        '0123456789',
        '9876543210',
        '87654321',
        '12345678',
        '123123123',
        '123412341234',
        '147258369',
        '741852963',
        '789456123',
        '784951623',
        '963852741',
        '123654789',
        '123698745',
        '7913456852',
        '986753421',
        '0123654789',
        '11223344',
        '111222333',
        '12344321',
        '1212121212',
        '110110110',
        '123456123456',
        '520520520',
        '3.1415926',
        '9527',
        '5211314',
        '5201314',
        '7758521',
        '5845131421',
        'abcdefghijklmnopqrstuvwxyz',
        'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
        'asdasdasd',
        'qweqweqwe',
        'zxczxczxc',
        'asdfasdf',
        'qwerqwer',
        'zxcvzxcv',
        'a123456789',
        'qq123456789',
        'q123456789',
        'abc123456',
        'aa123456',
        '1qaz2wsx3edc',
        '1q2w3e4r5t',
        'qwertyuiop',
        'asdfghjkl',
        'qweasdzxc',
        'woaini',
        'woaini1314',
        '1234qwer',
        'iloveyou',
        'imissyou',
        'password',
        'password001',
        'p@ssword',
        'passw0rd',
        'p@ssw0rd',
        'lifehack',
        'monkey',
        'consumer',
        'letmein',
        'dragon',
        'superman',
        'gizmodo',
        'sunshine',
        'master',
        'admin',
        'home',
        'delete',
        'insert',
        'scrolllock',
        'printscreen',
        'numlock',
        'ctrlaltdelete',
        'ctrl+alt+delete',
        'enter',
        'shift',
        'backspace',
        'fuckyou',
        'welcome',
        'internet',
        'javascript',
        'football',
        'blahblah',
        'buzhidao',
        'tiantianxiangshang',
        'haohaoxuexi',
        'shenmaqingkuang',
        'dangzhongyang',
        'cctv',
        'qq.com',
        '163.com',
        'baidu.com',
        'google.com',
        'gmail.com',
        'kengdie'
    ];

    function checkPwd(pwd) {
        var obj = {};
        obj.isSame = true;
        var cc = pwd.charCodeAt(0);
        for (var i = 0; i < pwd.length; i++) {
            var c = pwd.charCodeAt(i);
            if (cc != c) {
                obj.isSame = false;
            }
        }

        return obj;
    }
</script>

<h3>检测键盘是否大写锁定（Caps Lock键状态）</h3>
请按字母键测试：<input type="text"/>
<span id="spanCapsLock"></span>
<script type="text/javascript">
    var $lock = false;

    function checkCapsLock(fn) {
        document.documentElement.onkeypress = function (e) {
            var e = e || event;
            var k = e.keyCode || e.which;
            var s = e.shiftKey || (k == 16) || false;
            if (k >= 65 && k <= 90) $lock = !s;
            if (k >= 97 && k <= 122) $lock = s;

            fn($lock);
        }
        document.documentElement.onkeyup = function (e) {
            var e = e || event;
            var k = e.keyCode || e.which;
            if (k == 20) $lock = !$lock;

            fn($lock);
        }
    }

    checkCapsLock(function (bo) {
        document.getElementById('spanCapsLock').innerHTML = bo ? '大写' : '小写';
    });
</script>
</body>
</html>
